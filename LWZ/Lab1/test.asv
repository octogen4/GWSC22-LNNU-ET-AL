

%% Plot the sin signal

% Signal functions interface
sigscollect=sigfuns;

% Set Signal parameters then Generate the signals
f0=2; phi0=60; A = 10;
maxFreq = f0; samplFreq = 20*maxFreq;
sintimeVec=settimevec(samplFreq,0,1.0);
sinsigVec = sigscollect.sinsig(sintimeVec,A,[f0,phi0]);

f0=2; f1=4; phi0=60; A = 10;
maxFreq = f0+f1; samplFreq = 20*maxFreq;
lctimeVec=settimevec(samplFreq,0,1.0);
lcsigVec = sigscollect.lcsig(lctimeVec,A,[f0,f1,phi0]);

%Plot the signals
figure;
plot(sintimeVec,sinsigVec,'Marker','.','MarkerSize',18);
figure;
plot(lctimeVec,lcsigVec,'Marker','.','MarkerSize',18);

%Plot the periodogram
%--------------
%Length of data 
dataLen = timeVec(end)-timeVec(1);
%DFT sample corresponding to Nyquist frequency
kNyq = floor(nSamples/2)+1;
% Positive Fourier frequencies
posFreq = (0:(kNyq-1))*(1/dataLen);
% FFT of signal
fftSig = fft(sigVec);
% Discard negative frequencies
fftSig = fftSig(1:kNyq);

%Plot periodogram
figure;
plot(posFreq,abs(fftSig));

%Plot a spectrogram
%----------------
winLen = 0.2;%sec
ovrlp = 0.1;%sec
%Convert to integer number of samples 
winLenSmpls = floor(winLen*samplFreq);
ovrlpSmpls = floor(ovrlp*samplFreq);
[S,F,T]=spectrogram(sigVec,winLenSmpls,ovrlpSmpls,[],samplFreq);
figure;
imagesc(T,F,abs(S)); axis xy;
xlabel('Time (sec)');
ylabel('Frequency (Hz)');



